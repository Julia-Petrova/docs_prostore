---
layout: default
title: Разбор ошибок загрузки и обновления данных
nav_order: 4
parent: Другие действия
grand_parent: Работа с системой
has_children: false
has_toc: false
---

# Разбор ошибок загрузки и обновления данных {#upload_troubleshooting}

При возникновении ошибок во время [загрузки](../../data_upload/data_upload.md) или 
[обновления данных](../../data_update/data_update.md) система отменяет неуспешные 
[операции записи](../../../overview/main_concepts/write_operation/write_operation.md) и возвращает данные 
в состояние, которое предшествовало загрузке или обновлению. Однако в случае сбоя (например, неполадок в сети) операция 
может остаться заблокированной в состоянии выполнения или отмены. В этом случае нужно не только устранить причину ошибки, 
но и привести горячую [дельту](../../../overview/main_concepts/delta/delta.md) в корректное состояние, возобновив и (или) отменив 
заблокированные операции.

Все действия по устранению ошибок загрузки и обновления данных необходимо выполнять после завершения загрузки и обновления 
данных, то есть после получения ответа на соответствующий запрос.
{: .note-wrapper}

Чтобы устранить ошибки загрузки и обновления данных:
1. Выполните запрос [GET_WRITE_OPERATIONS](../../../reference/sql_plus_requests/GET_WRITE_OPERATIONS/GET_WRITE_OPERATIONS.md).
   *  Если в ответе присутствуют операции записи со статусом 0 («Выполняется») и исходным запросом 
      [UPSERT](../../../reference/sql_plus_requests/UPSERT/UPSERT.md), 
      [UPSERT SELECT](../../../reference/sql_plus_requests/UPSERT_SELECT/UPSERT_SELECT.md) или 
      [DELETE](../../../reference/sql_plus_requests/DELETE/DELETE.md), выполните запрос
      [ROLLBACK DELTA](../../../reference/sql_plus_requests/ROLLBACK_DELTA/ROLLBACK_DELTA.md) для отмены изменений по 
      **всем** операциям горячей дельты.
   * Иначе выполните запрос [RESUME_WRITE_OPERATION](../../../reference/sql_plus_requests/RESUME_WRITE_OPERATION/RESUME_WRITE_OPERATION.md)
     для возобновления заблокированных операций записи.
2. Устраните причину ошибки и повторите загрузку данных. Основные причины ошибок см. ниже.

## Основные причины ошибок загрузки и обновления данных {#error_reasons}

Основные причины ошибок загрузки данных:
* некорректная схема или записи Avro в [сообщениях топика Kafka](../../../reference/upload_format/upload_format.md);
* несоответствие порядка, количества или типа полей между сообщениями Kafka, 
  [логической таблицей](../../../overview/main_concepts/logical_table/logical_table.md) или 
  [внешней таблицей](../../../overview/main_concepts/external_table/external_table.md) загрузки (кроме поля `sys_op`, 
  которое должно присутствовать в сообщениях, но должно отсутствовать в таблицах);
* недостаточная продолжительность одного или нескольких интервалов ожидания, используемых при работе с брокером сообщений 
  Kafka (см. параметры <> в [конфигурации системы](../../../maintenance/configuration/system/system.md));
* расхождение времени между серверами инсталляции;
* некорректные настройки сервиса мониторинга статусов Kafka в конфигурации системы;
* некорректная установка коннектора для загрузки данных;
* некорректный путь к топику Kafka в настройках внешней таблицы загрузки.



Основные причины ошибок обновления данных:
* несоответствие порядка, количества и (или) типов столбцов между логической таблицей-приемником данных и запросом на 
обновление данных;
* отсутствие в запросе значений для обязательных столбцов;
* указание в запросе UPSERT SELECT тех [СУБД](../../../introduction/supported_DBMS/supported_DBMS.md) 
  [хранилища](../../../overview/main_concepts/data_storage/data_storage.md), для которых недоступна вставка данных 
  (подробнее см. в разделе [UPSERT SELECT](../../../reference/sql_plus_requests/UPSERT_SELECT/UPSERT_SELECT.md)). 